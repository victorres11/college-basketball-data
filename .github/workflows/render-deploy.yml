name: Deploy to Render

on:
  push:
    branches:
      - main
    paths:
      - 'web-ui/**'
      - 'foxsports_rosters/**'
      - '.github/workflows/render-deploy.yml'

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Render Deployment
        run: |
          MESSAGE=$(echo "${{ github.event.head_commit.message }}" | jq -Rs .)
          curl -X POST "${{ secrets.RENDER_WEBHOOK_URL }}" \
            -H "Content-Type: application/json" \
            -d "{\"ref\": \"${{ github.ref }}\", \"commit\": \"${{ github.sha }}\", \"message\": $MESSAGE}" \
            -f || echo "Webhook call failed"
        env:
          RENDER_WEBHOOK_URL: ${{ secrets.RENDER_WEBHOOK_URL }}

